!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).ZVideo=n()}(this,(function(){"use strict";function e(n){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}function n(e,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return o(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=e[i];return o}function t(e){return document.querySelector(e)}function r(e,n){e.style.display=n?"inline-block":"none"}function c(e,n){e.classList.add(n)}function s(e,n){e.classList.remove(n)}function l(e,n,i){e.style[n]=i}function u(e){e&&e.stopPropagation?(e.stopPropagation(),e.stopImmediatePropagation()):window.event.cancelBubble=!0}function a(e){e.onmousedown=function(e){return u(e),!1},e.onmouseup=function(e){return u(e),!1}}var d,v="00:00";function f(n){var i=e(n),o="00:00";if("number"===i||"string"===i){n=parseInt(n),n-=3600*Math.floor(n/3600);var t=Math.floor(n/60);n-=60*t,o=("0"+t).slice(-2)+":"+("0"+n).slice(-2)}else o="00:00";return v===o?null:v=o}return function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),d=this,Object.assign(d,n,{iconLink:"//at.alicdn.com/t/font_2197806_tdbemn1kgp.css",isPlay:!1,currentItem:null,currentIndex:0,percent:0,timeStr:"00:00",durationStr:"00:00",canplay:!1,isShowList:!1,isError:!1,isVoice:!0,isFull:!1,messageTime:3e3}),d.id?this._init():console.warn("\u8bf7\u8bbe\u7f6eid")}var o,v,p;return o=e,(v=[{key:"_init",value:function(){d.$el=t(this.id),d.$el.classList.add("z-video"),d.$el.innerHTML='<div class="z-video-container">\n                                <video  id="z-video" \n                                        rossOrigin="anonymous"\n                                        '.concat(d.autoplay&&'autoplay="true"'," \n                                        ").concat(d.muted&&'muted="true"',"\n                                        ").concat(d.loop&&'loop="true"',"\n                                        ").concat(d.poster&&'poster="'.concat(d.poster,'"'),'\n                                        style="width: ').concat(d.width?d.width+"px":"100%",";height: ").concat(d.height?d.height+"px":"auto",'">\n                                    <source class="z-video-source" type="video/mp4"/>\n                                    <source class="z-video-source" type="video/ogg"/>\n                                    <source class="z-video-source" type="video/webm"/>\n                                </video>\n                            </div>\n                            <div class="z-video-no-select z-video-control" id="z-video-control">\n                                <div class="z-progress">\n                                  <i class="z-progress-line" id="z-progress-line"></i>\n                                  <i class="z-progress-bar" id="z-progress-bar"></i>\n                                  <div id="z-progress" style="position: absolute;width: 100%;z-index: 999;height: 100%;"></div>\n                                </div>\n                                <div class="z-video-control-item">\n                                    <i id="z-play-pause" class="z-play-pause iconfont ').concat(d.autoplay?"icon-shitinghui":"icon-bofang",'"></i>\n                                    <i id="z-video-prev" class="z-video-prev iconfont icon-shangyiji"></i>\n                                    <i id="z-video-next" class="z-video-next iconfont icon-xiayiji"></i>\n                                    <span class="z-video-time"><i id="z-video-time">').concat(d.timeStr,'</i> / <i id="z-video-duration">').concat(d.durationStr,'</i></span>\n                                </div>\n                                <div class="z-video-control-item"> \n                                    <i id="z-video-voice" class="z-video-voice iconfont ').concat(d.isVoice?"icon-laba":"icon-guanbishengyin",'"></i>\n                                    <i id="z-video-full" class="z-video-full iconfont icon-quanping"></i>\n                                    <i id="z-video-list" class="z-video-list iconfont icon-liebiao"></i>\n                                </div>\n                            </div>\n                            <div class="z-video-list-content" id="z-video-list-content" style="width: 0">\n                                <p class="z-video-play-title"><i style="font-size: 14px;" class="iconfont icon-dayu"></i>\u64ad\u653e\u5217\u8868\uff08<span id="z-video-play-title">0</span>\uff09</p>\n                                <div class="z-video-list-box scrollbar" id="z-video-list-box"></div>\n                            </div>\n                            <i class="z-video-error iconfont icon-wangluocuowu1" id="z-video-error">\u7f51\u8def\u9519\u8bef</i>\n                            <i class="z-video-loading iconfont icon-jiazai" id="z-video-loading"></i>\n                            <span class="z-video-message" id="z-video-message"></span>\n                            <div class="z-video-pan"  id="z-video-audio">\n                                <i class="z-video-pan-circle c-1"></i>\n                                <i class="z-video-pan-circle c-2"></i>\n                                <i class="z-video-pan-circle c-3"></i>\n                                <i class="z-video-pan-circle c-4"></i>\n                                <i class="z-video-pan-circle c-5"></i>\n                                <i class="z-video-pan-circle c-6"></i>\n                                <i class="z-video-pan-circle c-7"></i>\n                                <i class="z-video-pan-circle c-8"></i>\n                                <i class="z-video-pan-circle c-9"></i>\n                                <i class="z-video-pan-circle c-10"></i>\n                                <i class="z-video-pan-circle c-11"></i>\n                                <i class="z-video-pan-circle c-12"></i>\n                                <i class="z-video-pan-circle c-13"></i>\n                                <i class="z-video-pan-circle c-14"></i>\n                                <i class="z-video-pan-circle c-15"></i>\n                                <i class="z-video-audio iconfont icon-yinpin1"></i>\n                            </div>\n                        ');var e=document.createElement("link");if(e.setAttribute("rel","stylesheet"),e.setAttribute("href",d.iconLink),document.head.appendChild(e),d.$video=t("#z-video"),d.$control=t("#z-video-control"),d.$play=t("#z-play-pause"),d.$prev=t("#z-video-prev"),d.$next=t("#z-video-next"),d.$time=t("#z-video-time"),d.$duration=t("#z-video-duration"),d.$voice=t("#z-video-voice"),d.$full=t("#z-video-full"),d.$list=t("#z-video-list"),d.$count=t("#z-video-play-title"),d.$listBox=t("#z-video-list-box"),d.$listView=t("#z-video-list-content"),d.$loading=t("#z-video-loading"),d.$progress=t("#z-progress"),d.$progressLine=t("#z-progress-line"),d.$progressBar=t("#z-progress-bar"),d.$message=t("#z-video-message"),d.$error=t("#z-video-error"),d.$audio=t("#z-video-audio"),!Array.isArray(d.sources))return d.sources=[],d.error_fn&&d.error_fn("\u8d44\u6e90\u5217\u8868\u4e0d\u80fd\u4e3a\u7a7a"),void d._message({type:"error",message:"\u8d44\u6e90\u5217\u8868\u4e0d\u80fd\u4e3a\u7a7a\uff01"});navigator.onLine||(d._message({type:"error",message:"\u7f51\u7edc\u9519\u8bef\uff01"}),d.error_fn&&d.error_fn("\u7f51\u7edc\u9519\u8bef"),r(d.$error,!0)),d._onChange(0),d._initVideo(),d._control(!1),d._initList(),d._initEvent()}},{key:"_initVideo",value:function(){d.$video.addEventListener("canplay",(function(){d.isError=!1,d.canplay=!0,d.durationStr=f(d.$video.duration),d.$duration.innerText=d.durationStr,d.isPlay?d._play():d._pause(),d._loading(!1),d.is_ctrl||d.is_init||(d.is_init=!0,d._control(!0)),r(d.$error,!1)})),d.$video.addEventListener("timeupdate",(function(e){d.percent=d.$video.currentTime/d.$video.duration*100,d._setTimeStr(),d._setBar(),d.timeupdate_fn&&d.timeupdate_fn(e)})),d.$video.addEventListener("ended",(function(){d._pause()})),d.$video.addEventListener("error",(function(e){d.isError=!0,d._pause(),d.error_fn&&d.error_fn("\u89c6\u9891\u52a0\u8f7d\u51fa\u73b0\u9519\u8bef",e),d._message({type:"error",message:"\u89c6\u9891\u52a0\u8f7d\u51fa\u73b0\u9519\u8bef\uff01"}),c(d.$listItme[d.currentIndex],"error")}))}},{key:"_initEvent",value:function(){function e(){d.canplay&&!d.is_ctrl&&d._control(!0)}function n(){d.$video.mousetimer=setTimeout((function(){d._control(!1),d._closeList()}),2200)}function i(){d.mouseDown=!0,c(d.$progressBar,"active"),c(d.$progressBar,"no"),d.$video.pause()}function o(e){d.mouseDown&&(s(d.$progressBar,"active"),s(d.$progressBar,"no"),d._setSliderPointerValue(e),d._setVideoTime(),d.isPlay&&d.$video.play(),d.mouseDown=!1)}function t(e){d.mouseDown&&d._setSliderPointerValue(e)}d.$video.onmouseover=function(){e()},d.$video.onmouseleave=function(){n()},d.$control.onmouseover=function(){e()},d.$control.onmouseleave=function(){n()},d.$listView.onmouseover=function(){e()},d.$listView.onmouseleave=function(){n()},a(d.$play),d.$play.onclick=function(e){u(e),d.isPlay?d._pause():d._play()},a(d.$list),d.$list.onclick=function(e){u(e),d.isShowList?d._closeList():d._openList()},a(d.$voice),d.$voice.onclick=function(e){d.isVoice?d._closeVoice():d._openVoice()},a(d.$full),d.$full.onclick=function(e){u(e),d.isFull?d._exitFull():d._full()},d.$video.onclick=function(e){u(e),d._closeList()},a(d.$prev),d.$prev.onclick=function(e){u(e),d._prev()},a(d.$next),d.$next.onclick=function(e){u(e),d._next()},d.$progress.onmousedown=function(){i()},d.$progress.onmouseup=function(e){o(e.offsetX)},d.$progress.onmousemove=function(e){t(e.offsetX)},d.$progress.onmouseleave=function(e){o(e.offsetX)},d.$progress.addEventListener("touchstart",(function(){i()})),d.$progress.addEventListener("touchend",(function(e){o(e.changedTouches[0].clientX)})),d.$progress.addEventListener("touchmove",(function(e){t(e.changedTouches[0].clientX)})),window.addEventListener("online",(function(){d._message({type:"success",message:"\u7f51\u8def\u5df2\u8fde\u63a5\uff01"}),r(d.$error,!1)})),window.addEventListener("offline",(function(){d._message({type:"error",message:"\u7f51\u8def\u5df2\u65ad\u5f00\uff01"}),r(d.$error,!0)})),window.addEventListener("resize",(function(){console.log("vm.isFull",d.isFull),d.isFull&&d._exitFull_fn()})),window.addEventListener("keyup",(function(e){32===e.keyCode&&(d.isPlay?d._pause():d._play()),39!==e.keyCode&&37!==e.keyCode||d.$video.play()})),window.addEventListener("keydown",(function(e){39===e.keyCode&&(d.$video.pause(),d.$video.currentTime+=5),37===e.keyCode&&(d.$video.pause(),d.$video.currentTime-=5)}))}},{key:"_message",value:function(e){"success"===e.type&&(s(d.$message,"error"),c(d.$message,"success")),"error"===e.type&&(s(d.$message,"success"),c(d.$message,"error")),d.$message.innerText=e.message,setTimeout((function(){s(d.$message,"success"),s(d.$message,"error"),d.$message.innerText=""}),d.messageTime)}},{key:"_setListIcon",value:function(e){r(d.$list,e)}},{key:"_control",value:function(e){e?c(d.$control,"active"):s(d.$control,"active"),e&&d.$video&&d.$video.mousetimer&&clearTimeout(d.$video.mousetimer),d.ctrl_fn&&d.ctrl_fn(e,d)}},{key:"_setPlayIcon",value:function(){d.canplay&&d.isPlay?(s(d.$play,"icon-bofang"),c(d.$play,"icon-shitinghui")):(s(d.$play,"icon-shitinghui"),c(d.$play,"icon-bofang"))}},{key:"_closeList",value:function(){l(d.$listView,"width","0"),d.isShowList=!1,d.list_fn&&d.list_fn(d,!1)}},{key:"_openList",value:function(){l(d.$listView,"width","245px"),d.isShowList=!0,d.list_fn&&d.list_fn(d,!0)}},{key:"_closeVoice",value:function(){s(d.$voice,"icon-laba"),c(d.$voice,"icon-guanbishengyin"),d.isVoice=!1,d.$video.muted=!0,d.voice_fn&&d.voice_fn(d,!1)}},{key:"_openVoice",value:function(){s(d.$voice,"icon-guanbishengyin"),c(d.$voice,"icon-laba"),d.isVoice=!0,d.$video.muted=!1,d.voice_fn&&d.voice_fn(d,!0)}},{key:"_pause",value:function(){d.isPlay=!1,d.$video.pause(),d._setPlayIcon(),s(d.$audio,"play"),d.pause_fn&&d.pause_fn(d)}},{key:"_play",value:function(){d.isPlay=!0,d.$video.play(),d._setPlayIcon(),c(d.$audio,"play"),d.play_fn&&d.play_fn(d)}},{key:"_load",value:function(){d.$video.load(),d._setPlayIcon(),d.load_fn&&d.load_fn(d)}},{key:"_prev",value:function(){d.percent=0,d._setBar(),d.currentIndex--,d.currentIndex<0&&(d.currentIndex=d.sources.length-1),d._onChange(d.currentIndex),d.$currentItem&&s(d.$currentItem,"active"),d.$currentItem=d.$listItme[d.currentIndex],c(d.$currentItem,"active"),d.prev_fn&&d.prev_fn(d)}},{key:"_next",value:function(){d.percent=0,d._setBar(),d.currentIndex++,d.currentIndex>d.sources.length-1&&(d.currentIndex=0),d._onChange(d.currentIndex),d.$currentItem&&s(d.$currentItem,"active"),d.$currentItem=d.$listItme[d.currentIndex],c(d.$currentItem,"active"),d.next_fn&&d.next_fn(d)}},{key:"_setVideoTime",value:function(){d.$video.currentTime=d.$video.duration*(d.percent/100)}},{key:"_setTimeStr",value:function(){d.timeStr=f(d.$video.currentTime),d.timeStr&&(d.$time.innerText=d.timeStr,d._statisticsDuration())}},{key:"_full",value:function(){d.full_fn&&d.full_fn(d,!0),c(d.$video,"full"),s(d.$full,"icon-quanping"),c(d.$full,"icon-eLongVideoPlayer_fullRecover"),d.$el.requestFullscreen?d.$el.requestFullscreen():d.$el.webkitRequestFullScreen?d.$el.webkitRequestFullScreen():d.$el.mozRequestFullScreen?d.$el.mozRequestFullScreen():d.$el.msRequestFullscreen(),setTimeout((function(){d.isFull=!0}),300)}},{key:"_exitFull",value:function(){d._exitFull_fn(),document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}},{key:"_exitFull_fn",value:function(){d.isFull=!1,d.full_fn&&d.full_fn(d,!1),s(d.$video,"full"),s(d.$full,"icon-eLongVideoPlayer_fullRecover"),c(d.$full,"icon-quanping")}},{key:"_setSliderPointerValue",value:function(e){var n=d.$progress.clientWidth,i=d.$progressBar.clientWidth,o=e-0-i/2,t=n-i;o<=0?o=0:o>=t&&(o=t),d.percent=o/t*100,d.left=o,d._setBar()}},{key:"_setBar",value:function(){l(d.$progressBar,"left",d.percent+"%"),l(d.$progressLine,"width",d.percent+"%")}},{key:"_initList",value:function(){if(1===d.sources.length)return this._setListIcon(!1),l(d.$full,"marginRight","0"),r(d.$prev,!1),void r(d.$next,!1);var e="";for(var n in d.sources.map((function(n,i){e+='<div  class="z-video-item" title="'.concat(n.title,'">').concat(n.title,"</div>")})),d.$listBox.innerHTML=e,d.$count.innerText=d.sources.length,d.$listItme=document.getElementsByClassName("z-video-item"),d.$currentItem=null,d.$listItme)d.$listItme[n]&&1===d.$listItme[n].nodeType&&function(e,n){d.$currentItem||n!=d.currentIndex||(c(e,"active"),d.$currentItem=e),e.onclick=function(i){d.$currentItem&&s(d.$currentItem,"active"),c(e,"active"),d.$currentItem=e,d._onChange(n)}}(d.$listItme[n],n)}},{key:"_onChange",value:function(e){d._loading(!0),d.percent=0,d._setBar(),d.currentIndex=e,d.currentItem=d.sources[d.currentIndex],d._setUrl(d.currentItem.url),d._load(),r(d.$audio,"audio"===d.currentItem.type)}},{key:"_setUrl",value:function(e){for(var n in d.sourceList||(d.sourceList=document.querySelectorAll(".z-video-source")),d.sourceList){var i=d.sourceList[n];i&&1===i.nodeType&&i.setAttribute("src",e)}}},{key:"_loading",value:function(e){r(d.$loading,e)}},{key:"_statisticsDuration",value:function(){var e=d.sources[d.currentIndex].timeLength;null==e&&(e=-1),e++,d.sources[d.currentIndex].timeLength=e}},{key:"play",value:function(){d._play()}},{key:"pause",value:function(){d._pause()}},{key:"prev",value:function(){d._prev()}},{key:"next",value:function(){d._next()}},{key:"openControl",value:function(){d._control(!0),d.is_ctrl=!1}},{key:"closeControl",value:function(){d._control(!1),d.is_ctrl=!0}},{key:"openList",value:function(){d._openList()}},{key:"closeList",value:function(){d._closeList()}},{key:"openVoice",value:function(){d._openVoice()}},{key:"closeVoice",value:function(){d._closeVoice()}},{key:"openFull",value:function(){d._full()}},{key:"closeFull",value:function(){d._exitFull()}},{key:"load",value:function(){d._load()}},{key:"setVoice",value:function(e){d.$voice.volume=e}},{key:"addEventListener",value:function(e,n){d[e+"_fn"]=n}},{key:"timeLength",value:function(){return i(d.sources)}}])&&n(o.prototype,v),p&&n(o,p),e}()}));
